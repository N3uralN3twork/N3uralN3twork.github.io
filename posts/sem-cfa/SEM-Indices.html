<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matthias Quinn">
<meta name="dcterms.date" content="2022-08-12">
<meta name="description" content="This post is a walkthrough of a structural equation model in R.">

<title>N3uralN3twork’s Website - Structural Equation Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/Combo-Chart-Icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>
    .quarto-title-block .quarto-title-banner {
      background: #FFAC1C;
    }
    </style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Structural Equation Modelling</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">Structural Equation Modelling</h1>
                  <div>
        <div class="description">
          This post is a walkthrough of a structural equation model in R.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Matthias Quinn </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 12, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/Transhumanism Logo for Website.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/N3uralN3twork/n3uraln3twork.github.io" title="Website" class="sidebar-tool px-1"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/N3uralN3twork" title="Personal Github" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/matthiasquinn" title="Personal Linkedin" class="sidebar-tool px-1"><i class="bi bi-linkedin"></i></a>
    <a href="mailto:miq_qedquinn@yahoo.com" title="Contact Me" class="sidebar-tool px-1"><i class="bi bi-question-circle"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../aboutme.html" class="sidebar-item-text sidebar-link">Who am I?</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resumes.html" class="sidebar-item-text sidebar-link">Resumes</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects.html" class="sidebar-item-text sidebar-link">Projects</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../pytorch.html" class="sidebar-item-text sidebar-link">PyTorch</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../publications.html" class="sidebar-item-text sidebar-link">Papers</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#software" id="toc-software" class="nav-link active" data-scroll-target="#software">Software</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#motivating-example" id="toc-motivating-example" class="nav-link" data-scroll-target="#motivating-example">Motivating Example</a></li>
  <li><a href="#definitions" id="toc-definitions" class="nav-link" data-scroll-target="#definitions">Definitions</a></li>
  <li><a href="#the-path-model" id="toc-the-path-model" class="nav-link" data-scroll-target="#the-path-model">The path model</a></li>
  <li><a href="#lavaan-syntax" id="toc-lavaan-syntax" class="nav-link" data-scroll-target="#lavaan-syntax">lavaan syntax</a></li>
  <li><a href="#simple-regression" id="toc-simple-regression" class="nav-link" data-scroll-target="#simple-regression">Simple regression</a></li>
  <li><a href="#maximum-likelihood-vs.-least-squares-estimators" id="toc-maximum-likelihood-vs.-least-squares-estimators" class="nav-link" data-scroll-target="#maximum-likelihood-vs.-least-squares-estimators">Maximum Likelihood vs.&nbsp;Least Squares Estimators</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/N3uralN3twork/n3uraln3twork.github.io/edit/main/posts/sem-cfa/SEM-Indices.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/N3uralN3twork/n3uraln3twork.github.io/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="columns">
<div class="column" style="width:40%;">
<section id="goal" class="level2">
<h2 class="anchored" data-anchor-id="goal">GOAL</h2>
<p>Learn how to create and interpret structural equation models using R’s lavaan.</p>
</section>
</div><div class="column" style="width:10%;">
<!-- empty column to create gap -->
</div><div class="column" style="width:40%;">
<section id="result" class="level2">
<h2 class="anchored" data-anchor-id="result">RESULT</h2>
<p><strong>WiP</strong></p>
</section>
</div>
</div>
<p>Structural Equation Models (SEM) help to model the dependence relationships among multiple variables, simultaneously. In other words, we can model not only multiple variables, but each of those dependent variables can have multiple covariates attached to them.</p>
<section id="software" class="level3">
<h3 class="anchored" data-anchor-id="software">Software</h3>
<p>There are a plethora of options available to create SEMs. Here are just a few of them:</p>
<ol type="1">
<li><a href="https://lavaan.ugent.be/">lavaan</a></li>
<li><a href="https://www.statmodel.com/">MPlus</a></li>
<li><a href="https://documentation.sas.com/doc/en/statug/15.2/statug_calis_overview09.htm">SAS</a></li>
<li><a href="https://www.stata.com/features/structural-equation-modeling/">Stata</a></li>
</ol>
<p>This project will use the <strong>lavaan</strong> library. If you don’t have it installed, simply run the following command in your IDE of choice:</p>
<div class="cell" data-hash="SEM-Indices_cache/html/unnamed-chunk-1_5063d820d506c1747fd5f73b0b41a2bf">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install.packages("lavaan", dependencies=TRUE)</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(lavaan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lavaan' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-12
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
</div>
<p>BTW, this walk-through is my interpretation of the fantastic <a href="https://stats.oarc.ucla.edu/r/seminars/rsem/">guide</a> created by UCLA.</p>
</section>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>Structural equation modeling is a linear model framework that models concrete regression equations with latent variables.</p>
</section>
<section id="motivating-example" class="level3">
<h3 class="anchored" data-anchor-id="motivating-example">Motivating Example</h3>
<p>Suppose you are a researcher studying the effects of student background on academic achievement. The lab recently finished collecting and uploading the dataset (<a href="https://stats.idre.ucla.edu/wp-content/uploads/2021/02/worland5.csv">worland5.csv</a>) of <span class="math inline">N= 500</span> students with <span class="math inline">9</span> observed variables for each student. The principal investigator hypothesizes three latent constructs Adjustment, Risk, Achievement measured with its corresponding to the following codebook mapping:</p>
<p><strong>Adjustment:</strong></p>
<ul>
<li><p>motiv Motivation</p></li>
<li><p>harm Harmony</p></li>
<li><p>stabi Stability</p></li>
</ul>
<p><strong>Risk:</strong></p>
<ul>
<li><p>ppsych (Negative) Parental Psychology</p></li>
<li><p>ses Socio-economic Status</p></li>
<li><p>verbal Verbal IQ</p></li>
</ul>
<p><strong>Achievement:</strong></p>
<ul>
<li><p>read Reading</p></li>
<li><p>arith Arithmetic</p></li>
<li><p>spell Spelling</p></li>
</ul>
<p>Here’s how to download and load the dataset into R:</p>
<div class="cell" data-hash="SEM-Indices_cache/html/unnamed-chunk-2_69e64d90dad39bfe41c5bc49ae921a5a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://stats.idre.ucla.edu/wp-content/uploads/2021/02/worland5.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Key
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The most essential component of a structural equation model is <strong>covariance</strong> or the statistical relationship between items. The true population covariance, denoted <span class="math inline">\Sigma</span>, is called the variance-covariance matrix. Since you don’t ever know the true <span class="math inline">\Sigma</span>, you can estimate it with your sample data. We call this the sample variance-covariance matrix, or <span class="math inline">\hat{\Sigma}</span>.</p>
</div>
</div>
</div>
<p>The variance-covariance matrix <span class="math inline">\Sigma</span> should not be confused with <span class="math inline">\Sigma(\theta)</span> which is the model. However, if the model fits perfectly, then <span class="math inline">\Sigma = \Sigma(\theta)</span>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Running the <strong>cov</strong> command in R allows us to obtain the population variance-covariance matrix <span class="math inline">\Sigma</span>?</p>
<p><em>Answer</em>: False, the <code>cov</code> command obtains the sample, or <span class="math inline">S</span>.</p>
</div>
</div>
</div>
</section>
<section id="definitions" class="level3">
<h3 class="anchored" data-anchor-id="definitions">Definitions</h3>
<ul>
<li><strong>observed variable:</strong> a variable that exists in the data, a.k.a <strong>item</strong> or manifest variable</li>
</ul>
<!-- -->
<ul>
<li><p><strong>latent variable:</strong> a variable that is constructed and does not exist in the data</p></li>
<li><p><strong>exogenous variable:</strong> an independent variable either observed (x) or latent (<span class="math inline">\Xi</span>) that explains an endogenous variable</p></li>
<li><p><strong>endogenous variable:</strong> a dependent variable, either observed (y) or latent (<span class="math inline">\eta</span>) that has a causal path leading to it</p></li>
<li><p><strong>measurement model:</strong> a model that links observed variables with latent variables</p></li>
<li><p><strong>indicator:</strong> an observed variable in a measurement model (can be exogenous or endogenous)</p></li>
<li><p><strong>factor</strong>: a latent variable defined by its indicators (can be exogenous or endogenous)</p></li>
<li><p><strong>loading:</strong> a path between an indicator and a factor</p></li>
<li><p><strong>structural model:</strong> a model that specifies causal relationships among exogenous variables to endogenous variables (can be observed or latent)</p></li>
<li><p><strong>regression path:</strong> a path between exogenous and endogenous variables (can be observed or latent)</p></li>
<li><p><span class="math inline">x_1</span>, a single exogenous variable</p></li>
<li><p><span class="math inline">y_1</span>, single endogenous variable</p></li>
<li><p><span class="math inline">\beta_0, \alpha_1</span>, intercept of <span class="math inline">y_1</span>, “alpha”</p></li>
<li><p><span class="math inline">\beta_1, \gamma_1</span>, regression coefficient, “gamma”</p></li>
<li><p><span class="math inline">\phi</span>, variance or covariance of the exogenous variable, “phi”</p></li>
<li><p><span class="math inline">\psi</span>, residual variance or covariance of the endogenous variable, “psi”</p></li>
</ul>
</section>
<section id="the-path-model" class="level3">
<h3 class="anchored" data-anchor-id="the-path-model">The path model</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Path Diagram Legend.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Copyright UCLA</figcaption><p></p>
</figure>
</div>
</section>
<section id="lavaan-syntax" class="level3">
<h3 class="anchored" data-anchor-id="lavaan-syntax">lavaan syntax</h3>
<p>Before running our first regression analysis, let us introduce some of the most frequently used syntax in <strong><code>lavaan</code></strong></p>
<ul>
<li><p><strong><code>~</code></strong> <strong>predict</strong>, used for regression of observed outcome to observed predictors (e.g., <strong><code>y ~ x</code></strong>)</p></li>
<li><p><strong><code>=~</code></strong> <strong>indicator</strong>, used for latent variable to observed indicator in factor analysis measurement models (e.g., <strong><code>f =~ q + r + s</code></strong>)</p></li>
<li><p><strong><code>~~</code></strong> <strong>covariance</strong> (e.g., <strong><code>x ~~ x</code></strong>)</p></li>
<li><p><strong><code>~1</code></strong> <strong>intercept</strong> or mean (e.g., <strong><code>x ~ 1</code></strong> estimates the mean of variable <strong><code>x</code></strong>)</p></li>
<li><p><strong><code>1*</code></strong> <strong>fixes</strong> <strong>parameter</strong> or loading to one (e.g., <strong><code>f =~ 1*q</code></strong>)</p></li>
<li><p><strong><code>NA*</code></strong> <strong>frees</strong> <strong>parameter</strong> or loading (useful to override default marker method,&nbsp;(e.g., <strong><code>f =~ NA*q</code></strong>)</p></li>
<li><p><strong><code>a*</code></strong> <strong>labels</strong> the <strong>parameter</strong> ‘a’, used for model constraints&nbsp;(e.g., <strong><code>f =~ a*q</code></strong>)</p></li>
</ul>
</section>
<section id="simple-regression" class="level3">
<h3 class="anchored" data-anchor-id="simple-regression">Simple regression</h3>
<p>Simple regression models the relationship of an observed exogenous variable on a single observed endogenous variable. For a single subject, the simple linear regression equation is most commonly defined as:</p>
<p><span class="math display">
y_1 = \beta_0 + \beta_1x_1 + \epsilon_1
</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="UCLA - Model 1A.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Copyright UCLA</figcaption><p></p>
</figure>
</div>
<p>In R, the most basic way to run a linear regression is to use the <code>lm()</code> function:</p>
<div class="cell" data-hash="SEM-Indices_cache/html/unnamed-chunk-3_edc695bbcf2cec2ecacce8071187c0e4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">#simple regression using lm()</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>m1a <span class="ot">&lt;-</span> <span class="fu">lm</span>(read <span class="sc">~</span> motiv, <span class="at">data=</span>dat)</span>
<span id="cb5-3"><a href="#cb5-3"></a>(fit1a <span class="ot">&lt;-</span><span class="fu">summary</span>(m1a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = read ~ motiv, data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-26.0995  -6.1109   0.2342   5.2237  24.0183 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.232e-07  3.796e-01    0.00        1    
motiv        5.300e-01  3.800e-02   13.95   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.488 on 498 degrees of freedom
Multiple R-squared:  0.2809,    Adjusted R-squared:  0.2795 
F-statistic: 194.5 on 1 and 498 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The predicted mean of <strong><code>read</code></strong> is <span class="math inline">0</span> for a student with <strong><code>motiv</code></strong>=<span class="math inline">0</span> and for a one unit increase in motivation, the reading score improves <span class="math inline">0.530</span> points. Make special note of the residual standard error which is 8.488. The square of that <span class="math inline">8.4882=72.04</span> is the residual variance, which we will see later in <strong><code>lavaan()</code></strong>. We can run the equivalent code in lavaan. The syntax is very similar to <strong><code>lm()</code></strong> in that <strong><code>read ~ motiv</code></strong> specifies the predictor <strong><code>motiv</code></strong> on the outcome <strong><code>read</code></strong>. However, by default the intercept is not included in the output but is implied. If we want to add an intercept, we need to include <strong><code>read ~ 1 + motiv</code></strong>. Optionally, you can request the variance of <strong><code>motiv</code></strong> using <strong><code>motiv ~~ motiv</code></strong>. If this syntax is not provided, the parameter is still estimated but just implied.</p>
<div class="cell" data-hash="SEM-Indices_cache/html/unnamed-chunk-4_016097f1c23e6d875d2cec534cbdc174">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#simple regression using lavaan </span></span>
<span id="cb7-4"><a href="#cb7-4"></a>modelOne <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">  # regressions</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">    read ~ 1 + motiv</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="st">  # variance (optional)</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="st">    motiv ~~ motiv</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="st">"</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>fitOne <span class="ot">&lt;-</span> <span class="fu">sem</span>(modelOne, <span class="at">data=</span>dat)</span>
<span id="cb7-11"><a href="#cb7-11"></a></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="fu">summary</span>(fitOne)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 8 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           500

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  read ~                                              
    motiv             0.530    0.038   13.975    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .read             -0.000    0.379   -0.000    1.000
    motiv             0.000    0.447    0.000    1.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    motiv            99.800    6.312   15.811    0.000
   .read             71.766    4.539   15.811    0.000</code></pre>
</div>
</div>
<p>Notice how the intercept of <code>read (0.000)</code> and the regression coefficient of <code>read ~ motiv (0.530)</code> matches the output of the linear model, with small rounding errors. The intercept for <code>motiv (0.000)</code> does not have a <code>.</code> and neither does its variance of <span class="math inline">99.80</span>, meaning that it’s an exogenous mean and variance.</p>
<p>Also, an important piece of output is that the estimator of use is <strong>M.L.</strong>, also known as <strong>Maximum Likelihood</strong>. The <code>lm()</code> function uses the least squares estimator.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Small Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <code>.</code> in front of the parameter denotes an endogenous variable under intercepts and a residual variance if it’s under Variances or Co-variances.</p>
</div>
</div>
</div>
</section>
<section id="maximum-likelihood-vs.-least-squares-estimators" class="level3">
<h3 class="anchored" data-anchor-id="maximum-likelihood-vs.-least-squares-estimators">Maximum Likelihood vs.&nbsp;Least Squares Estimators</h3>
<p>For <strong>least squares</strong>, the estimate for the residual variance is:</p>
<p><span class="math display">
\hat{\sigma}^2_{LS} = \frac{\sum_{i=1}^{N} \hat{\zeta_i}^2}{N-k}
</span></p>
<p>where <span class="math inline">N</span> is the sample size and <span class="math inline">k</span> is the number of predictors <span class="math inline">+1</span> for the intercept. For <strong>maximum likelihood</strong>, the estimate for the residual variance is:</p>
<p><span class="math display">
\hat{\sigma}^2_{ML} = \frac{\sum_{i=1}^{N} \hat{\zeta_i}^2}{N}
</span></p>
<p>Here is the conversion between the two methods for the residual variance:</p>
<p><span class="math display">
\hat{\sigma}^2_{ML} = \left(\frac{N-k}{n}\right) \hat{\sigma}^2_{LS}
</span></p>
<p>You can tell <em>lavaan</em> to use a generalized least squares estimator by calling <code>estimator=GLS</code> in the fit function.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© CC-By Matthias Quinn, 2023</div>   
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>